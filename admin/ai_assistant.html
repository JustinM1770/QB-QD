<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asistente IA QuickBite - Impulsa tus Ventas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="assets/css/ai_assistant.css">
    <style>
        /* Estilos adicionales para el editor de menú */
        .menu-editor { background: #f8fafc; border-radius: 12px; padding: 20px; margin-top: 15px; }
        .product-card { background: white; border-radius: 10px; padding: 15px; margin-bottom: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); display: flex; align-items: center; gap: 15px; transition: all 0.2s ease; border: 2px solid transparent; }
        .product-card:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.12); border-color: #4f46e5; }
        .product-card.editing { border-color: #f59e0b; background: #fffbeb; }
        .product-image { width: 70px; height: 70px; border-radius: 8px; object-fit: cover; background: #e2e8f0; flex-shrink: 0; }
        .product-info { flex: 1; min-width: 0; }
        .product-name { font-weight: 600; color: #1e293b; margin-bottom: 4px; }
        .product-desc { font-size: 0.85em; color: #64748b; margin-bottom: 4px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .product-price { font-weight: 700; color: #059669; font-size: 1.1em; }
        .product-category { font-size: 0.75em; background: #e0e7ff; color: #4338ca; padding: 2px 8px; border-radius: 10px; display: inline-block; margin-top: 4px; }
        .product-actions { display: flex; flex-direction: column; gap: 6px; }
        .btn-edit, .btn-delete { width: 36px; height: 36px; border-radius: 8px; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s ease; }
        .btn-edit { background: #dbeafe; color: #2563eb; }
        .btn-edit:hover { background: #2563eb; color: white; }
        .btn-delete { background: #fee2e2; color: #dc2626; }
        .btn-delete:hover { background: #dc2626; color: white; }
        .upload-zone { border: 2px dashed #cbd5e1; border-radius: 12px; padding: 30px; text-align: center; background: #f8fafc; transition: all 0.3s ease; cursor: pointer; margin-bottom: 15px; }
        .upload-zone:hover, .upload-zone.dragover { border-color: #4f46e5; background: #eef2ff; }
        .upload-zone i { font-size: 2.5em; color: #94a3b8; margin-bottom: 10px; }
        .upload-zone.dragover i { color: #4f46e5; }
        .preview-images { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 15px; }
        .preview-item { position: relative; width: 100px; height: 100px; }
        .preview-item img { width: 100%; height: 100%; object-fit: cover; border-radius: 8px; border: 2px solid #e2e8f0; }
        .preview-item .remove-preview { position: absolute; top: -8px; right: -8px; width: 24px; height: 24px; background: #dc2626; color: white; border: none; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 12px; }
        .edit-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; align-items: center; justify-content: center; }
        .edit-modal.active { display: flex; }
        .edit-modal-content { background: white; border-radius: 16px; padding: 25px; width: 90%; max-width: 500px; max-height: 90vh; overflow-y: auto; box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
        .edit-modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #e2e8f0; }
        .edit-modal-header h3 { margin: 0; color: #1e293b; }
        .close-modal { background: none; border: none; font-size: 1.5em; cursor: pointer; color: #64748b; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 500; color: #374151; }
        .form-group input, .form-group textarea, .form-group select { width: 100%; padding: 10px 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 1em; transition: border-color 0.2s; }
        .form-group input:focus, .form-group textarea:focus, .form-group select:focus { outline: none; border-color: #4f46e5; box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1); }
        .btn-save-edit { width: 100%; padding: 12px; background: #4f46e5; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; margin-top: 10px; }
        .btn-save-edit:hover { background: #4338ca; }
        .menu-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #e2e8f0; flex-wrap: wrap; gap: 10px; }
        .menu-stats { display: flex; gap: 20px; }
        .stat-item { text-align: center; }
        .stat-value { font-size: 1.5em; font-weight: 700; color: #4f46e5; }
        .stat-label { font-size: 0.8em; color: #64748b; }
        .menu-actions { display: flex; gap: 10px; flex-wrap: wrap; }
        .btn-action { padding: 10px 20px; border-radius: 8px; border: none; font-weight: 500; cursor: pointer; display: flex; align-items: center; gap: 8px; transition: all 0.2s ease; }
        .btn-primary { background: #4f46e5; color: white; }
        .btn-primary:hover { background: #4338ca; }
        .btn-secondary { background: #f1f5f9; color: #475569; }
        .btn-secondary:hover { background: #e2e8f0; }
        .btn-danger { background: #fee2e2; color: #dc2626; }
        .btn-danger:hover { background: #dc2626; color: white; }
        .category-filters { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 15px; }
        .category-filter { padding: 6px 14px; border-radius: 20px; border: 1px solid #e2e8f0; background: white; cursor: pointer; font-size: 0.85em; transition: all 0.2s ease; }
        .category-filter:hover, .category-filter.active { background: #4f46e5; color: white; border-color: #4f46e5; }
        .search-box { position: relative; margin-bottom: 15px; }
        .search-box input { width: 100%; padding: 10px 15px 10px 40px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 0.95em; }
        .search-box i { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: #94a3b8; }
        .upload-progress { display: none; margin-top: 15px; }
        .upload-progress.active { display: block; }
        .progress-bar { height: 8px; background: #e2e8f0; border-radius: 4px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #4f46e5, #7c3aed); width: 0%; transition: width 0.3s ease; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        .progress-text { text-align: center; margin-top: 10px; font-size: 0.9em; color: #64748b; }
        .btn-add-product { width: 100%; padding: 15px; border: 2px dashed #cbd5e1; border-radius: 10px; background: transparent; color: #64748b; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; margin-top: 10px; transition: all 0.2s ease; }
        .btn-add-product:hover { border-color: #4f46e5; color: #4f46e5; background: #eef2ff; }
    </style>
</head>
<body>
    <div class="header">
        <h1>
            <i class="fas fa-robot"></i> Asistente IA QuickBite
        </h1>
        <div class="header-actions">
            <button class="quick-btn" data-action="analyze_sales">
                <i class="fas fa-chart-line"></i> Análisis Rápido
            </button>
            <button class="quick-btn" data-action="get_recommendations">
                <i class="fas fa-lightbulb"></i> Recomendaciones
            </button>
            <div class="status-badge online">
                <i class="fas fa-check-circle"></i> IA Conectada
            </div>
        </div>
    </div>
    
    <div class="main-container">
        <div class="grid-container">
            <div class="sidebar grid-item" id="sidebar">
                <h3><i class="fas fa-tachometer-alt"></i> Dashboard</h3>
                <div id="quickInsights">
                    <div class="text-center text-muted">
                        <p>Cargando insights...</p>
                    </div>
                </div>
            </div>
            
            <div class="chat-container grid-item">
                <div class="messages" id="messages"></div>
                
                <div class="input-area">
                    <label class="upload-btn" id="uploadMenuBtn" onclick="openUploadModal()">
                        <i class="fas fa-camera"></i> Subir Menú
                    </label>
                    
                    <input type="text" id="messageInput" placeholder="Pregúntame lo que quieras: ¿Qué puedo hacer para vender más?...">
                    
                    <button id="sendBtn">
                        <i class="fas fa-paper-plane"></i> Enviar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de edición de producto -->
    <div class="edit-modal" id="editModal">
        <div class="edit-modal-content">
            <div class="edit-modal-header">
                <h3><i class="fas fa-edit"></i> <span id="modalTitle">Editar Producto</span></h3>
                <button class="close-modal" onclick="closeEditModal()">&times;</button>
            </div>
            <form id="editProductForm">
                <input type="hidden" id="editProductIndex">
                <div class="form-group">
                    <label><i class="fas fa-tag"></i> Nombre del producto</label>
                    <input type="text" id="editNombre" required placeholder="Ej: Hamburguesa Clásica">
                </div>
                <div class="form-group">
                    <label><i class="fas fa-align-left"></i> Descripción</label>
                    <textarea id="editDescripcion" rows="3" placeholder="Describe el producto..."></textarea>
                </div>
                <div class="form-group">
                    <label><i class="fas fa-dollar-sign"></i> Precio</label>
                    <input type="number" id="editPrecio" step="0.01" min="0" required placeholder="0.00">
                </div>
                <div class="form-group">
                    <label><i class="fas fa-folder"></i> Categoría</label>
                    <select id="editCategoria"><option value="">Seleccionar categoría...</option></select>
                </div>
                <div class="form-group">
                    <label><i class="fas fa-fire"></i> Calorías (opcional)</label>
                    <input type="number" id="editCalorias" min="0" placeholder="Ej: 450">
                </div>
                <button type="submit" class="btn-save-edit"><i class="fas fa-save"></i> Guardar Cambios</button>
            </form>
        </div>
    </div>

    <!-- Modal de subir imágenes -->
    <div class="edit-modal" id="uploadModal">
        <div class="edit-modal-content" style="max-width: 600px;">
            <div class="edit-modal-header">
                <h3><i class="fas fa-images"></i> Analizar Menú con IA</h3>
                <button class="close-modal" onclick="closeUploadModal()">&times;</button>
            </div>
            
            <div class="upload-zone" id="uploadZone">
                <i class="fas fa-cloud-upload-alt"></i>
                <p><strong>Arrastra tus imágenes aquí</strong></p>
                <p style="color: #94a3b8; font-size: 0.9em;">o haz clic para seleccionar (máx. 5 imágenes)</p>
                <input type="file" id="multiFileInput" accept="image/*" multiple style="display: none;">
            </div>
            
            <div class="preview-images" id="previewImages"></div>
            
            <div class="upload-progress" id="uploadProgress">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p class="progress-text" id="progressText">Analizando imágenes con IA...</p>
            </div>
            
            <div style="margin-top: 20px; display: flex; gap: 10px;">
                <button class="btn-action btn-secondary" onclick="closeUploadModal()" style="flex: 1;">
                    <i class="fas fa-times"></i> Cancelar
                </button>
                <button class="btn-action btn-primary" id="startAnalysisBtn" onclick="startImageAnalysis()" style="flex: 2;" disabled>
                    <i class="fas fa-magic"></i> Analizar con IA
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/ai_assistant.js?v=20260104"></script>
</body>
</html>
